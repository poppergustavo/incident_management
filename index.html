<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Classificador de Prioridade</title>
  <link rel="icon" href="https://images.seeklogo.com/logo-png/32/2/philips-logo-png_seeklogo-326304.png" type="image/png">

  <style>
    body {
      display: flex;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f4f7fa;
    }
    .side-panel {
      width: 20%;
      padding: 10px;
      background-color: #e3e7ed;
      height: 100vh;
      overflow-y: auto;
      border-right: 2px solid #ccc;
    }
    .main-panel {
      width: 60%;
      padding: 20px;
      background-color: #ffffff;
      height: 100vh;
      overflow-y: auto;
      border-right: 2px solid #ccc;
    }
    h2 {
      margin-top: 0;
      color: #333;
    }
    .result {
      margin-top: 20px;
      font-weight: bold;
      font-size: 18px;
      color: #0a3d62;
    }
    .messages {
      margin-top: 10px;
      color: #b71540;
    }
    form label {
      display: block;
      margin: 8px 0;
    }
    select {
      margin: 5px 0;
      padding: 5px;
    }
    .side-panel ul {
      padding-left: 20px;
    }
    .side-panel li {
      margin-bottom: 8px;
      font-size: 16px;
    }
    .indicativo {
    display: inline-block;
    font-size: 12px;
    color: #3f5353;
    margin-left: 8px;
    vertical-align: middle;
    font-size: small;
}
  </style>
</head>
<body>

  <div class="side-panel">
    <h2>üìå Legenda de Prioridades</h2>
    <ul>
      <li>üî¥ 1 - Cr√≠tica</li>
      <li>üü† 2 - Alta</li>
      <li>üü° 3 - M√©dia</li>
      <li>üü¢ 4 - Baixa</li>
      <li>‚ö™ 5 - Sem prioridade</li>
    </ul>
  </div>

  <div class="main-panel">
    <h2>üìù Formul√°rio de Identifica√ß√£o</h2>
    <form id="incidentForm">
      <label><input type="checkbox" id="danoPaciente"> Dano reportado ao paciente?</label>
      <p class="indicativo">Cliente reportou que houve dano ao paciente. Como por exemplo, ficar sem medica√ß√£o.</p>
      <label><input type="checkbox" id="possivelDano"> Poss√≠vel dano ao paciente?</label>
      <p class="indicativo">Situa√ß√£o pode levar complica√ß√µes ao tratamento do paciente.</p>
      <label><input type="checkbox" id="sistemaFora"> Sistema/Fun√ß√£o fora do ar?</label>
      <select id="tipoSistemaFora" style="display:none">
        <option value="">Selecione o tipo</option>
        <option value="sistema">Sistema</option>
        <option value="funcao">Fun√ß√£o</option>
      </select>
      <div id="tipoFuncaoExtra" style="display:none">
        <label><input type="radio" name="tipoFuncao" value="assistencial"> Assistencial</label>
        <label><input type="radio" name="tipoFuncao" value="backoffice"> Backoffice</label>
      </div>

      <label><input type="checkbox" id="degradacaoServico"> Degrada√ß√£o no servi√ßo?</label>
      <p class="indicativo">Erros, lentid√£o ou demora e travamentos que compromentem o uso da fun√ß√£o/servi√ßo.</p>
      <select id="tipoDegradacao" style="display:none">
        <option value="erro">Erro</option>
        <option value="lentidao">Lentid√£o</option>
        <option value="travamento">Travamento</option>
      </select>
      <div id="tipoDegradacaoExtra" style="display:none">
        <label><input type="radio" name="tipoDegradacaoAmbiente" value="assistencial"> Assistencial</label>
        <label><input type="radio" name="tipoDegradacaoAmbiente" value="backoffice"> Backoffice</label>
      </div>

      <label><input type="checkbox" id="umUsuario"> Apenas um usu√°rio afetado</label>
      <p class="indicativo">Por exemplo, apenas um usu√°rio est√° com erro.</p>
      <label><input type="checkbox" id="multiplosUsuarios"> M√∫ltiplos usu√°rios afetados</label>
      <p class="indicativo">Por exemplo, m√∫ltiplos usu√°rios com erro.</p>
      <label><input type="checkbox" id="operacaoCritica"> Evento compromete opera√ß√£o cr√≠tica?</label>
      <p class="indicativo">Como utiliza√ß√£o de uma fun√ß√£o ou processo/servi√ßo espec√≠fico.</p>
      <select id="tipoOperacao" style="display:none">
        <option value="">Selecione</option>
        <option value="paciente">Fun√ß√£o vital</option>
        <option value="financeiro">Backoffice</option>
      </select>

      <label><input type="checkbox" id="riscoSLA"> Risco de viola√ß√£o de SLA</label>
      <p class="indicativo">Como quebra de tempo de atendimento ou de contrato em geral.</p>
      <label><input type="checkbox" id="acaoImediata"> Exige a√ß√£o imediata</label>
      <p class="indicativo">Necess√°rio atuar imediatamente.</p>

      <label>Vers√£o do Cliente:
        <select id="versaoCliente">
          <option value="">Selecione</option>
          <option value="1842">1842</option>
          <option value="1838">1838</option>
          <option value="1835">1835</option>
          <option value="1832">1832 ou abaixo</option>
        </select>
      </label>

      <label>Ambiente:
        <select id="ambiente">
          <option value="">Selecione</option>
          <option value="producao">Produ√ß√£o</option>
          <option value="homologacao">Homologa√ß√£o/Testes</option>
        </select>
      </label>
    </form>

    <div class="result" id="resultado"></div>
    <div class="messages" id="mensagens"></div>
  </div>

  <div class="side-panel">
    <h2>üìä Resultado Atual</h2>
    <p id="resultadoFinal"></p>
  </div>

  <script>
    const form = document.getElementById('incidentForm');
    const resultado = document.getElementById('resultado');
    const mensagens = document.getElementById('mensagens');
    const resultadoFinal = document.getElementById('resultadoFinal');

    form.addEventListener('change', avaliar);

    function emojiPrioridade(prioridade) {
      return {
        1: 'üî¥',
        2: 'üü†',
        3: 'üü°',
        4: 'üü¢',
        5: '‚ö™'
      }[prioridade] || '';
    }

    function avaliar() {
      let prioridade = 5;
      let msgs = [];

      const danoPaciente = document.getElementById('danoPaciente').checked;
      const possivelDano = document.getElementById('possivelDano').checked;
      const sistemaFora = document.getElementById('sistemaFora').checked;
      const tipoSistema = document.getElementById('tipoSistemaFora').value;
      const tipoFuncao = document.querySelector('input[name="tipoFuncao"]:checked');

      const degradacao = document.getElementById('degradacaoServico').checked;
      const tipoDegradacao = document.getElementById('tipoDegradacao').value;
      const tipoAmbienteDegrad = document.querySelector('input[name="tipoDegradacaoAmbiente"]:checked');

      const umUsuario = document.getElementById('umUsuario').checked;
      const multiplosUsuarios = document.getElementById('multiplosUsuarios').checked;
      const operacaoCritica = document.getElementById('operacaoCritica').checked;
      const tipoOperacao = document.getElementById('tipoOperacao').value;

      const riscoSLA = document.getElementById('riscoSLA').checked;
      const acaoImediata = document.getElementById('acaoImediata').checked;

      const versaoCliente = document.getElementById('versaoCliente').value;
      const ambiente = document.getElementById('ambiente').value;

      document.getElementById('tipoSistemaFora').style.display = sistemaFora ? 'inline' : 'none';
      document.getElementById('tipoFuncaoExtra').style.display = (sistemaFora && tipoSistema === 'funcao') ? 'block' : 'none';

      document.getElementById('tipoDegradacao').style.display = degradacao ? 'inline' : 'none';
      document.getElementById('tipoDegradacaoExtra').style.display = degradacao ? 'block' : 'none';

      document.getElementById('tipoOperacao').style.display = operacaoCritica ? 'inline' : 'none';

      if (danoPaciente) prioridade = 1;
      else if (possivelDano) prioridade = 2;

      if (sistemaFora) {
        if (tipoSistema === 'sistema') prioridade = 1;
        if (tipoSistema === 'funcao' && tipoFuncao) {
          if (tipoFuncao.value === 'assistencial') prioridade = 2;
          if (tipoFuncao.value === 'backoffice') prioridade = 3;
        }
      }

      if (degradacao && tipoAmbienteDegrad) {
        if (tipoAmbienteDegrad.value === 'assistencial') prioridade = 2;
        if (tipoAmbienteDegrad.value === 'backoffice') prioridade = 3;
      }

      if (multiplosUsuarios) {
        if (prioridade !== 1) msgs.push("Alterado para Cr√≠tica por m√∫ltiplos usu√°rios afetados.");
        prioridade = 1;
      }

      if (operacaoCritica && tipoOperacao === 'paciente') {
        if (prioridade !== 1 && prioridade !== 2) prioridade = 2;
        else if (prioridade === 1) msgs.push("Opera√ß√£o cr√≠tica mas j√° est√° como Cr√≠tica.");
      }

      if (riscoSLA) {
        if (prioridade > 1) prioridade -= 1;
        msgs.push("Risco de SLA ‚Äì prioridade agravada.");
      }

      if (acaoImediata) {
        if (prioridade !== 1) prioridade = 1;
        else msgs.push("J√° √© Cr√≠tica ‚Äì a√ß√£o imediata confirmada.");
      }

      if (["1832"].includes(versaoCliente) && prioridade >= 3) {
        msgs.push("Vers√£o fora da pol√≠tica. Verifique contrato.");
      }

      if (ambiente === 'producao') {
        msgs.push("Base de produ√ß√£o.");
      } else if (ambiente === 'homologacao' && prioridade < 3) {
        msgs.push("Ambiente n√£o produtivo ‚Äì revisar prioridade.");
      }

      const emoji = emojiPrioridade(prioridade);
      resultado.textContent = `Prioridade atribu√≠da: ${emoji} ${prioridade}`;
      resultadoFinal.textContent = `Prioridade atual: ${emoji} ${prioridade}`;
      mensagens.innerHTML = msgs.map(m => `<div>üìå ${m}</div>`).join('');
    }
  </script>
</body>
</html>
